!function(e){var t={};function r(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(s,i,function(t){return e[t]}.bind(null,i));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);let s,i;class o{constructor(e){if(this.AI={},this.PLAYER={},this.size=e,e){let t=function(e,t){let r=[],s=0;for(let t=0;t<e;t++){r[t]=[];for(let s=0;s<e;s++)r[t][s]=[]}for(let i=0;i<e;i++)for(let o=0;o<e-t+1;o++){for(let e=0;e<t;e++)r[i][o+e][s]=!0;s++}for(let i=0;i<e;i++)for(let o=0;o<e-t+1;o++){for(let e=0;e<t;e++)r[o+e][i][s]=!0;s++}for(let i=0;i<e-t+1;i++)for(let o=0;o<e-t+1;o++){for(let e=0;e<t;e++)r[i+e][o+e][s]=!0;s++}for(let i=0;i<e-t+1;i++)for(let o=e-1;o>t-2;o--){for(let e=0;e<t;e++)r[i+e][o-e][s]=!0;s++}return{wins:r,count:s}}(e,5);this.root=!0,s=t.wins,i=t.count}this.AIscore=0,this.AIwins=new Array(i).fill(0),this.PLAYERscore=0,this.PLAYERwins=new Array(i).fill(0)}add(e,t,r){if(this.has(e,t))return this;if(this[r][`${e}-${t}`]=new n(e,t),"AI"===r){for(let r=0;r<i;r++)if(s[e][t][r]&&(this.AIwins[r]++,this.PLAYERwins[r]<5&&(this.PLAYERwins[r]=6),this.root&&5===this.AIwins[r]))return alert("你输了"),setTimeout(()=>{location.reload()},2e3),document.querySelectorAll(".row").forEach((r,s)=>{s===e&&Array.from(r.children).forEach((e,r)=>{r===t&&e.classList.add("black")})}),void(window.gameover=!0);this.updateScore(...arguments)}else if("PLAYER"===r){for(let r=0;r<i;r++)if(s[e][t][r]&&(this.PLAYERwins[r]++,this.AIwins[r]<5&&(this.AIwins[r]=6),this.root&&5===this.PLAYERwins[r]))return alert("你赢了"),setTimeout(()=>{location.reload()},2e3),void(window.gameover=!0);this.updateScore(...arguments)}return this}updateScore(e,t,r){if("PLAYER"===r){let r=1,o=1,n=1,c=1;for(let a=0;a<i;a++)s[e][t][a]&&(0==this.PLAYERwins[a]?this.PLAYERscore+=1:1==this.PLAYERwins[a]?(this.PLAYERscore+=5*r,r+=.1):2==this.PLAYERwins[a]?(this.PLAYERscore+=70*o,o+=.2):3==this.PLAYERwins[a]?(this.PLAYERscore+=300*n,n+=.5):4==this.PLAYERwins[a]?(this.PLAYERscore+=3e3*c,c+=1):5==this.PLAYERwins[a]&&(this.PLAYERscore+=1e5))}else if("AI"===r){let r=1,o=1,n=1,c=1;for(let a=0;a<i;a++)s[e][t][a]&&(0==this.AIwins[a]?this.AIscore+=1:1==this.AIwins[a]?(this.AIscore+=5*r,r+=.1):2==this.AIwins[a]?(this.AIscore+=70*o,o+=.2):3==this.AIwins[a]?(this.AIscore+=300*n,n+=.5):4==this.AIwins[a]?(this.AIscore+=3e3*c,c+=1):5==this.AIwins[a]&&(this.AIscore+=1e5))}}has(e,t,r){return r?this[r][`${e}-${t}`]:this.AI[`${e}-${t}`]||this.PLAYER[`${e}-${t}`]}copy(){let e=new o;for(let[t,r]of Object.entries(this.AI))e.add(r.x,r.y,"AI");for(let[t,r]of Object.entries(this.PLAYER))e.add(r.x,r.y,"PLAYER");return e.AIscore=this.AIscore,e.PLAYERscore=this.PLAYERscore,e.size=this.size,e.AIwins=this.AIwins.slice(),e.PLAYERwins=this.PLAYERwins.slice(),e}evaluate(){return this.AIscore-this.PLAYERscore}}class n{constructor(e,t){this.x=e,this.y=t}}class c{constructor(e,t=null,r=[]){this.val=e,this.children=r,this.parent=t,this.score}}class a{constructor(e,t=[]){this.val=e,this.parent=null,this.children=t,this.score}}window.board=new class{constructor(e){this.chessboard=new Array(e).fill(null).map(t=>new Array(e)),this.size=e,this.occupied=new o(e),this.curIdentity="PLAYER",console.log(this.chessboard)}occupy(e,t){this.occupied.add(e,t,this.curIdentity),this.curIdentity="PLAYER"==this.curIdentity?"AI":"PLAYER"}buildTree(e=1,t=new a(this.occupied),r=this.curIdentity){if(e--,t.parent&&(r="PLAYER"==r?"AI":"PLAYER"),0===e){if(t.score=t.val.evaluate(),"PLAYER"===r){if(t.parent&&t.score>(t.parent.score||-1/0)&&(t.parent.score=t.score),t.parent&&t.parent.parent&&t.parent.parent.score&&t.score>=t.parent.parent.score)return}else if("AI"===r&&(t.parent&&t.score<(t.parent.score||1/0)&&(t.parent.score=t.score),t.parent&&t.parent.parent&&t.parent.parent.score&&t.score<=t.parent.parent.score))return;return t}for(let s=0;s<this.size;s++)for(let i=0;i<this.size;i++){if(t.val.has(s,i))continue;const o=new c(t.val.copy().add(s,i,r),t);o.currentPos=[s,i];const n=this.buildTree(e,o,r);if(!n)return t;if(t.children.push(n),"PLAYER"===r){if(t.parent&&t.parent.parent&&t.parent.parent.score&&t.score>=t.parent.parent.score)return}else if("AI"===r&&t.parent&&t.parent.parent&&t.parent.parent.score&&t.score<=t.parent.parent.score)return}return"PLAYER"===r?t.parent&&t.score>(t.parent.score||-1/0)&&(t.parent.score=t.score):"AI"===r&&t.parent&&t.score<(t.parent.score||1/0)&&(t.parent.score=t.score),t}next(e){const t=this.buildTree(e);return t.children.filter(e=>e.score===t.score)[0].currentPos}}(14);const l=document.querySelectorAll(".row");let h="PLAYER";function u(e){const t=board.next(e);console.log(t),l.forEach((e,r)=>{r===t[0]&&Array.from(e.children).forEach((e,r)=>{r===t[1]&&e.click()})})}l.forEach((e,t)=>{Array.from(e.children).forEach((e,r)=>{e.addEventListener("click",()=>{window.gameover||("PLAYER"===h?(h="PLAYER"===h?"AI":"PLAYER",e.classList.add("white"),board.occupy(t,r),setTimeout(u,0,3)):"AI"===h&&(h="PLAYER"===h?"AI":"PLAYER",e.classList.add("black"),board.occupy(t,r)))},{once:!0})})})}]);